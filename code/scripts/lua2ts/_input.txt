local hAbility = EntIndexToHScript(params.entindex_inflictor_const or -1)
	--- @type CDOTA_BaseNPC
	local hVictim = EntIndexToHScript(params.entindex_victim_const or -1)
	local hAttacker = EntIndexToHScript(params.entindex_attacker_const or -1)

	if IsValid(hAttacker) and hAttacker ~= hVictim and params.damage > 0 then
		local fDamage = params.damage
		local iDamageType = params.damagetype_const
		local iPlayerID = hAttacker:GetPlayerOwnerID()

		if PlayerResource:IsValidPlayerID(iPlayerID) then
			local hHero = PlayerResource:GetSelectedHeroEntity(iPlayerID)
			hAttacker = hAttacker:GetSource()
			if hHero ~= hAttacker then
				if iDamageType == DAMAGE_TYPE_NONE then
					iDamageType = DAMAGE_TYPE_PURE
				end
				if hAttacker:IsBuilding() and hAttacker.GetBuilding ~= nil then
					local hBuilding = hAttacker:GetBuilding()
					local sTowerName = hBuilding:GetUnitEntityName()

					hBuilding:ModifyTotalDamage(fDamage)

					Rounds:AddRoundDamage(iPlayerID, hAttacker, sTowerName, iDamageType, fDamage)
				end
			end
		end